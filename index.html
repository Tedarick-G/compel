<!doctype html>
<html lang="tr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>T-Soft • Compel • Aide Karşılaştırma</title>

    <!-- Projende varsa mevcut css dosyanı burada tut -->
    <link rel="stylesheet" href="./style.css" />

    <!-- Basit fallback (projende style.css varsa bu yine de sorun çıkarmaz) -->
    <style>
      :root{
        --bg:#0f0f10; --bg-panel:#17181a;
        --text:#f2f3f5; --text-2:#b7bbc4;
        --border-2:#2a2d33;
        --popM:12; --popGap:10;
      }
      body{margin:0;background:var(--bg);color:var(--text);font:14px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Arial}
      .app{max-width:1400px;margin:0 auto;padding:14px}
      .topbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
      .chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:var(--bg-panel);border:1px solid var(--border-2);font-weight:800}
      .chip.ok{border-color:rgba(134,239,172,.35)}
      .chip.bad{border-color:rgba(232,60,97,.45)}
      .chip.unk{border-color:rgba(250,204,21,.35)}
      .chip.muted{opacity:.85}
      .rowSep{height:12px}
      .main{display:grid;grid-template-columns:360px 1fr;gap:14px;align-items:start}
      @media (max-width: 980px){.main{grid-template-columns:1fr}}
      .panel{background:var(--bg-panel);border:1px solid var(--border-2);border-radius:14px;padding:12px}
      .panel h3{margin:0 0 10px;font-size:14px;letter-spacing:.02em}
      .btn{cursor:pointer;border:1px solid var(--border-2);background:#101113;color:var(--text);border-radius:10px;padding:9px 12px;font-weight:900}
      .btn.wip{opacity:.55;cursor:not-allowed}
      .btnRow{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
      .brandList{display:flex;flex-direction:column;gap:8px;max-height:66vh;overflow:auto;padding-right:6px}
      .brand{border:1px solid var(--border-2);border-radius:12px;padding:10px 10px;background:#121316;cursor:pointer;user-select:none}
      .brand.sel{outline:2px solid rgba(134,239,172,.35)}
      .bRow{display:flex;justify-content:space-between;gap:10px;align-items:center}
      .bNm{font-weight:950}
      .bCt{opacity:.75;font-weight:900}
      .listTitleBar{background:var(--bg-panel);border:1px solid var(--border-2);border-radius:14px;padding:10px 12px;font-weight:950}
      .tableWrap{background:var(--bg-panel);border:1px solid var(--border-2);border-radius:14px;overflow:auto}
      table{border-collapse:collapse}
      th,td{padding:8px 8px;border-bottom:1px solid rgba(255,255,255,.06)}
      th{font-weight:1000;text-align:left}
      td.left{text-align:left}
      .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.35);z-index:999}
      .modalInner{background:var(--bg-panel);border:1px solid var(--border-2);border-radius:14px;padding:12px;min-width:320px;max-width:min(520px,92vw)}
      textarea{width:100%;min-height:160px;border:1px solid var(--border-2);border-radius:12px;background:#101113;color:var(--text);padding:10px;box-sizing:border-box}
      .muted{opacity:.8}
    </style>
  </head>

  <body>
    <div class="app">
      <div class="topbar">
        <span id="supplierLabel" class="chip muted">1) Tedarikçi: Compel</span>

        <span id="brandStatus" class="chip muted">Hazır • Marka: 0/0</span>
        <button id="brandHintBtn" class="btn" type="button" title="Marka listesini vurgula">Marka</button>

        <span id="stChip" class="chip ok" style="display:none">Hazır</span>

        <span id="l1Chip" class="chip muted">Compel:-</span>
        <span id="l2Chip" class="chip muted">T-Soft:-</span>
        <span id="l4Chip" class="chip muted">Aide:-</span>
        <span id="sum" class="chip muted">✓0 • ✕0</span>

        <!-- Tedarikçi seçimi -->
        <div id="supplierWrap" style="position:relative">
          <button id="supplierBtn" class="btn" type="button" aria-expanded="false">Tedarikçi</button>
          <div
            id="supplierMenu"
            class="panel"
            style="position:absolute;top:44px;left:0;min-width:220px;display:block;visibility:hidden;opacity:0;transform:translateY(-4px);transition:.12s;z-index:50"
            aria-hidden="true"
          >
            <div class="btnRow" style="flex-direction:column;align-items:stretch">
              <button id="supplierCompelItem" class="btn" type="button">Compel</button>
              <button id="supplierAllItem" class="btn" type="button">Tüm Markalar</button>
              <button id="supplierAkalinItem" class="btn" type="button">Akalın</button>
              <button id="supplierAddBtn" class="btn" type="button" style="opacity:.7">+</button>
            </div>
          </div>
        </div>

        <script>
          // Menü görünürlük animasyonu için küçük helper (app.js zaten class show kullanıyor)
          (function(){
            const menu=document.getElementById('supplierMenu');
            if(!menu) return;
            const obs=new MutationObserver(()=>{
              const show=menu.classList.contains('show');
              menu.style.visibility=show?'visible':'hidden';
              menu.style.opacity=show?'1':'0';
              menu.style.transform=show?'translateY(0)':'translateY(-4px)';
            });
            obs.observe(menu,{attributes:true,attributeFilter:['class']});
          })();
        </script>
      </div>

      <div class="rowSep" aria-hidden="true"></div>

      <div class="main">
        <!-- SOL PANEL -->
        <aside class="panel">
          <h3>Markalar</h3>

          <div id="leftControls" class="btnRow">
            <!-- Listele / Temizle -->
            <button id="go" class="btn" type="button" title="Listele">Listele</button>

            <!-- ✅ CSV Çıktı butonu kaldırıldı (dl1 yok) -->

            <!-- T-Soft yükleme alanı -->
            <div id="sescBox" class="btn" style="display:inline-flex;align-items:center;gap:10px" role="button" tabindex="0" title="T-Soft Stok CSV Seç">
              <span class="muted">T-Soft</span>
              <span id="n2" class="chip muted" style="padding:4px 10px">Yükle</span>
              <input id="f2" type="file" accept=".csv,.txt" style="display:none" />
            </div>

            <!-- Günlük butonları -->
            <button id="tsoftDailyBtn" class="btn" type="button" disabled>—</button>
            <button id="aideDailyBtn" class="btn" type="button" disabled>—</button>

            <!-- Aide / Depo -->
            <button id="depoBtn" class="btn" type="button" title="Aide verisi yükle/yapıştır">Aide</button>
          </div>

          <div class="rowSep" aria-hidden="true"></div>

          <div id="brandList" class="brandList" aria-label="Marka Listesi"></div>
        </aside>

        <!-- SAĞ PANEL -->
        <section class="maincol">
          <!-- app.js buraya listTitle ve ayraç ekliyor -->
          <div id="infoBox" class="panel">
            <div class="muted">
              Marka seç → T-Soft yükle (veya günlük seç) → Aide yükle (veya günlük seç) → Listele
            </div>
          </div>

          <div class="rowSep" aria-hidden="true"></div>

          <div class="tableWrap">
            <table id="t1" aria-label="Eşleşen Ürünler"></table>
          </div>

          <div class="rowSep" aria-hidden="true"></div>

          <section id="unmatchedSection" class="panel" style="display:none">
            <div id="unmatchedTitle" class="listTitleBar" style="margin-bottom:10px">Eşleşmeyen Ürünler</div>
            <div class="tableWrap">
              <table id="t2" aria-label="Eşleşmeyen Ürünler"></table>
            </div>
          </section>

          <section id="unmatchedSplitSection" class="panel" style="display:none">
            <div id="unmatchedSplitTitle" class="listTitleBar" style="margin-bottom:10px">Eşleşmeyen Ürünler</div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
              <div class="tableWrap"><table id="t2L" aria-label="T-Soft unmatched"></table></div>
              <div class="tableWrap"><table id="t2R" aria-label="Aide unmatched"></table></div>
            </div>
          </section>
        </section>
      </div>
    </div>

    <!-- T-Soft seçim modalı -->
    <div id="tsoftModal" class="modal" aria-hidden="true">
      <div id="tsoftInner" class="modalInner">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
          <div style="font-weight:950">T-Soft Dosyası</div>
          <button id="tsoftDismiss" class="btn" type="button">Kapat</button>
        </div>

        <div class="rowSep" aria-hidden="true"></div>

        <div class="btnRow">
          <button id="tsoftClose" class="btn" type="button">Dosya Seç</button>
          <label class="chip muted" style="gap:8px">
            <input id="tsoftSaveToday" type="checkbox" />
            Bugün için kaydet
          </label>
          <span id="tsoftPrev" class="chip muted" style="display:none"></span>
        </div>
      </div>
    </div>

    <!-- Aide / Depo modalı -->
    <div id="depoModal" class="modal" aria-hidden="true">
      <div id="depoInner" class="modalInner">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
          <div style="font-weight:950">Aide (Depo) Verisi</div>
          <button id="depoClose" class="btn" type="button">Kapat</button>
        </div>

        <div class="rowSep" aria-hidden="true"></div>

        <div id="depoSpin" class="muted" style="margin-bottom:8px">Tablolu metni buraya yapıştırın…</div>

        <textarea id="depoPaste" placeholder="Tablolu kopya (TSV/CSV) yapıştır…"></textarea>

        <div class="rowSep" aria-hidden="true"></div>

        <div class="btnRow" style="justify-content:space-between">
          <div class="btnRow">
            <button id="depoPasteBtn" class="btn" type="button">Panodan Yapıştır</button>
            <button id="depoClear" class="btn" type="button">Temizle</button>
          </div>

          <div class="btnRow">
            <span id="aideSaveLine" class="chip muted" style="display:none">Kaydet</span>
            <label class="chip muted" style="gap:8px">
              <input id="aideSaveToday" type="checkbox" />
              Bugün için kaydet
            </label>
            <button id="depoLoad" class="btn" type="button">Yükle</button>
            <span id="aidePrev" class="chip muted" style="display:none"></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Uygulama -->
    <script type="module" src="./js/app.js"></script>
  </body>
</html>
